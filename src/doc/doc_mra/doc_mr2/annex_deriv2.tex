\chapter*{Appendix D: Generalization of Derivative Needed for Minimization}
\label{annexC}
\addcontentsline{toc}{chapter}{Appendix D:  Generalization of Derivative Needed for Minimization}

The contribution of the wavelet coefficient $x$ to the noise and signal
information in the general case is
\begin{eqnarray}
h_n(x) & = & \int_{0}^{\mid x \mid } p_n(u|x) (\frac{\partial h(x)}{\partial 
x})_{x=u} du \\ \nonumber 
h_s(x) & = & \int_{0}^{\mid x \mid } p_s(u|x) (\frac{\partial h(x)}{\partial 
x})_{x=u} du
\end{eqnarray}

Assuming $h(x) = \frac{1}{2}x^2$, we have
\begin{eqnarray}
h_n(x) & = & \int_{0}^{\mid x \mid } p_n(x-u) u du \\ \nonumber 
h_s(x) & = & \int_{0}^{\mid x \mid } p_s(x-u) u du
\end{eqnarray}


\begin{eqnarray}
\frac{ d h_{s}(x)}{dx} = \int_0^x  \frac{\partial P_s(x-u)}{\partial x})_{x=u} u du +
         \frac{1}{dx}  \int_x^{x+dx} P_s(x-u) u  du
\end{eqnarray}

As $P_s(0) = 0$, the second term tends to zero.

Denoting  $\frac{\partial P_s(x-u)}{\partial x} = - \frac{\partial P_s(x-u)}{\partial u}$, we have  
\begin{eqnarray}
\frac{ d h_{s}(x)}{dx} & = & - \int_0^x \frac{\partial P_s(x-u)}{\partial u} u du \\
& = &  - ( [u P_s(x-u) ]_0^x - \int_0^w P_s(x-u) du) \\
& = & \int_0^x P_s(x-u) du \\
& = & \int_0^x P_s(u) du
\end{eqnarray}

and from $h_n = h - h_s$ we get
\begin{eqnarray}
\frac{ d h_{n}(x)}{dx} & = &  x -  \int_0^x P_s(u) du
\end{eqnarray}
and 
\begin{eqnarray}
\frac{ d h_{s}(y-x)}{dx} = - \int_0^{y-x} P_s(u) du
\end{eqnarray}

It is easy to verify that replacing $P_s(x) = \mbox{erf}(x)$, 
and $P_n(x) = \mbox{erfc}(x)$,
(case of Gaussian noise) we find the same equation as in Appendix B.

